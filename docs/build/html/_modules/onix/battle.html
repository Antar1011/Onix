

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>onix.battle &mdash; Onix 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Onix 0.1 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Onix
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="simple">
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Onix</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>onix.battle</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for onix.battle</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Classes for structuring battle logs&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">from</span> <span class="nn">onix.dto</span> <span class="kn">import</span> <span class="n">Moveset</span><span class="p">,</span> <span class="n">PokeStats</span>


<span class="k">def</span> <span class="nf">_update_battle_state</span><span class="p">(</span><span class="n">initial_battle_state</span><span class="p">,</span> <span class="n">events</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_battle_state (BattleState) :</span>
<span class="sd">        events (:obj:`iterable` of :obj:`Event`) :</span>

<span class="sd">    Returns:</span>
<span class="sd">        BattleState : the updated battle state</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError : if an effect in an event is inconsistent with the current</span>
<span class="sd">            battle state</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">battle_state</span> <span class="o">=</span> <span class="n">initial_battle_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">battle_state</span>

<span class="n">Slot_</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Slot&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;side&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">])</span>

<span class="n">HPctChange_</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;HPctChange&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;slot&#39;</span><span class="p">,</span> <span class="s1">&#39;old_pct&#39;</span><span class="p">,</span>
                                                    <span class="s1">&#39;new_pct&#39;</span><span class="p">])</span>
<span class="n">ConditionChange_</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;ConditionChange&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;slot&#39;</span><span class="p">,</span>
                                                              <span class="s1">&#39;condition&#39;</span><span class="p">,</span>
                                                              <span class="s1">&#39;recovery&#39;</span><span class="p">])</span>
<span class="n">StageChange_</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;StageChange&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;slot&#39;</span><span class="p">,</span> <span class="s1">&#39;stat&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;old_stage&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;new_stage&#39;</span><span class="p">])</span>
<span class="n">FieldChange_</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;FieldChange&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;side&#39;</span><span class="p">,</span> <span class="s1">&#39;field_condition&#39;</span><span class="p">,</span>
                                                      <span class="s1">&#39;ending&#39;</span><span class="p">])</span>
<span class="n">MovesetChange_</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;MovesetChange&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;slot&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;old_moveset&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;new_moveset&#39;</span><span class="p">])</span>

<span class="n">Matchup_</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Matchup&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;initial_battle_state&#39;</span><span class="p">,</span>
                                              <span class="s1">&#39;final_battle_state&#39;</span><span class="p">,</span>
                                              <span class="s1">&#39;resolution&#39;</span><span class="p">])</span>


<div class="viewcode-block" id="Slot"><a class="viewcode-back" href="../../onix.html#onix.battle.Slot">[docs]</a><span class="k">class</span> <span class="nc">Slot</span><span class="p">(</span><span class="n">Slot_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A reliable way to reference a Pokemon in a battle.</span>

<span class="sd">    Args:</span>
<span class="sd">        side (1 or 2) : the player number</span>
<span class="sd">        index (int) : the index of the Pokemon on the player&#39;s team</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="BattleState"><a class="viewcode-back" href="../../onix.html#onix.battle.BattleState">[docs]</a><span class="k">class</span> <span class="nc">BattleState</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The state of the battle</span>

<span class="sd">    Args:</span>
<span class="sd">        teams: </span>
<span class="sd">        leads: </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">teams</span><span class="p">,</span> <span class="n">leads</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">teams</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">movesets</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">:</span>
            <span class="n">team</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">moveset</span> <span class="ow">in</span> <span class="n">movesets</span><span class="p">:</span>
                <span class="n">team</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;moveset&#39;</span><span class="p">:</span> <span class="n">moveset</span><span class="p">,</span>
                             <span class="s1">&#39;hpct&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>
                             <span class="s1">&#39;nonvolatile_condition&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                             <span class="s1">&#39;volatile_condition&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(),</span>
                             <span class="s1">&#39;stages&#39;</span><span class="p">:</span> <span class="n">PokeStats</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">teams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">team</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active</span> <span class="o">=</span> <span class="n">leads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field_conditions</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turn_number</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="BattleState.copy"><a class="viewcode-back" href="../../onix.html#onix.battle.BattleState.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Effect"><a class="viewcode-back" href="../../onix.html#onix.battle.Effect">[docs]</a><span class="k">class</span> <span class="nc">Effect</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A change in the conditions of the battle. Could be damage infliction, could</span>
<span class="sd">    be a condition change (volatile, like confusion, or non-volatile, like burn</span>
<span class="sd">    or faint), or could be a change to the field (e.g. weather). Could be caused</span>
<span class="sd">    by a move, an item, an ability or a field effect (e.g. entry hazards)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="nd">@abc.abstractmethod</span>
<div class="viewcode-block" id="Effect.apply_effect"><a class="viewcode-back" href="../../onix.html#onix.battle.Effect.apply_effect">[docs]</a>    <span class="k">def</span> <span class="nf">apply_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">battle_state</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the effect to a battle state</span>

<span class="sd">        Args:</span>
<span class="sd">            battle_state (BattleState) : the battle state to which to apply</span>
<span class="sd">                the effect</span>
<span class="sd">            inplace (:obj:`bool`, optional) : if ``False``, makes a copy of the</span>
<span class="sd">                battle state before applying the effect, if ``True``, operate</span>
<span class="sd">                in-place. Default is ``True``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BattleState : the updated battle state</span>
<span class="sd">            </span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError : if the effect is inconsistent with the current battle</span>
<span class="sd">                state</span>
<span class="sd">        &quot;&quot;&quot;</span></div></div>


<div class="viewcode-block" id="HPctChange"><a class="viewcode-back" href="../../onix.html#onix.battle.HPctChange">[docs]</a><span class="k">class</span> <span class="nc">HPctChange</span><span class="p">(</span><span class="n">HPctChange_</span><span class="p">,</span> <span class="n">Effect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A change in hit points, represented as percent health (exact, not rounded)</span>

<span class="sd">    Args:</span>
<span class="sd">        slot (Slot) : the slot of the affected Pokemon</span>
<span class="sd">        old_pct (float) : 100 * pre-event hit points / max hit points</span>
<span class="sd">        new_pct (float) : 100 * post-event hit points / max hit points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="HPctChange.apply_effect"><a class="viewcode-back" href="../../onix.html#onix.battle.HPctChange.apply_effect">[docs]</a>    <span class="k">def</span> <span class="nf">apply_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">battle_state</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the HP change</span>

<span class="sd">        Args:</span>
<span class="sd">            battle_state (BattleState) : the battle state to which to apply</span>
<span class="sd">                the effect</span>
<span class="sd">            inplace (:obj:`bool`, optional) : if ``False``, makes a copy of the</span>
<span class="sd">                battle state before applying the effect, if ``True``, operate</span>
<span class="sd">                in-place. Default is ``True``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BattleState : the updated battle state</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError : if the old HP of the specified Pokemon isn&#39;t what is</span>
<span class="sd">                expected by the effect.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">battle_state</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">slot</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">side</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        
        <span class="c1"># sanity check</span>
        <span class="k">if</span> <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;hpct&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_pct</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Pokemon&#39;s current HP is inconsistent with the&quot;</span>
                             <span class="s2">&quot; expected HP for this effect.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Pokemon&#39;s current state:</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Expected hpct: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_pct</span><span class="p">))</span>
        
        <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;hpct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_pct</span>

        <span class="k">return</span> <span class="n">battle_state</span></div></div>


<div class="viewcode-block" id="VolatileConditionChange"><a class="viewcode-back" href="../../onix.html#onix.battle.VolatileConditionChange">[docs]</a><span class="k">class</span> <span class="nc">VolatileConditionChange</span><span class="p">(</span><span class="n">ConditionChange_</span><span class="p">,</span> <span class="n">Effect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A change in volatile condition (e.g. confusion).</span>

<span class="sd">    Args:</span>
<span class="sd">        slot (Slot) : the slot of the affected Pokemon</span>
<span class="sd">        condition (str) : the condition</span>
<span class="sd">        recovery (bool) : ``False`` if this is a new condition (the Pokemon was</span>
<span class="sd">            previously unafflicted), ``True`` if the Pokemon is recovering from</span>
<span class="sd">            this condition</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="VolatileConditionChange.apply_effect"><a class="viewcode-back" href="../../onix.html#onix.battle.VolatileConditionChange.apply_effect">[docs]</a>    <span class="k">def</span> <span class="nf">apply_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">battle_state</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the volatile condition change</span>

<span class="sd">        Args:</span>
<span class="sd">            battle_state (BattleState) : the battle state to which to apply</span>
<span class="sd">                the effect</span>
<span class="sd">            inplace (:obj:`bool`, optional) : if ``False``, makes a copy of the</span>
<span class="sd">                battle state before applying the effect, if ``True``, operate</span>
<span class="sd">                in-place. Default is ``True``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BattleState : the updated battle state</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError : if you&#39;re trying to cure the Pokemon of a condition it</span>
<span class="sd">                doesn&#39;t have or inflict it with a condition it already has</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">battle_state</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">slot</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">side</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="c1"># sanity check</span>
        <span class="n">has_condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="ow">in</span> <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;volatile_condition&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">has_condition</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recovery</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Pokemon&#39;s current volatile condition is &quot;</span>
                             <span class="s2">&quot;inconsistent with the expected condition for this&quot;</span>
                             <span class="s2">&quot; effect.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Pokemon&#39;s current state:</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Expected to have {1} condition: {2}&quot;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recovery</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recovery</span><span class="p">:</span>
            <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;volatile_condition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;volatile_condition&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">battle_state</span></div></div>
    

<div class="viewcode-block" id="NonVolatileConditionChange"><a class="viewcode-back" href="../../onix.html#onix.battle.NonVolatileConditionChange">[docs]</a><span class="k">class</span> <span class="nc">NonVolatileConditionChange</span><span class="p">(</span><span class="n">ConditionChange_</span><span class="p">,</span> <span class="n">Effect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A change in non-volatile (e.g. burn or faint).</span>

<span class="sd">    Args:</span>
<span class="sd">        slot (Slot) : the slot of the affected Pokemon</span>
<span class="sd">        condition (str) : the condition</span>
<span class="sd">        recovery (bool) : ``False`` if this is a new condition (the Pokemon was</span>
<span class="sd">            previously unafflicted), ``True`` if the Pokemon is recovering from</span>
<span class="sd">            this condition</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="NonVolatileConditionChange.apply_effect"><a class="viewcode-back" href="../../onix.html#onix.battle.NonVolatileConditionChange.apply_effect">[docs]</a>    <span class="k">def</span> <span class="nf">apply_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">battle_state</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the non-volatile condition change</span>

<span class="sd">        Args:</span>
<span class="sd">            battle_state (BattleState) : the battle state to which to apply</span>
<span class="sd">                the effect</span>
<span class="sd">            inplace (:obj:`bool`, optional) : if ``False``, makes a copy of the</span>
<span class="sd">                battle state before applying the effect, if ``True``, operate</span>
<span class="sd">                in-place. Default is ``True``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BattleState : the updated battle state</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError : if ``self.condition`` is &quot;faint&quot; and ``self.recovery``</span>
<span class="sd">                is True (there&#39;s no reviving)</span>
<span class="sd">            ValueError : if you&#39;re trying to cure the Pokemon of a condition it</span>
<span class="sd">                doesn&#39;t have or inflict it with a condition (besides faint) when</span>
<span class="sd">                it already has a condition</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">==</span> <span class="s1">&#39;faint&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recovery</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pokemon cannot be revived.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">battle_state</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">slot</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">side</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="c1"># sanity check</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recovery</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">expected_condition</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">expected_condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span>

        <span class="k">if</span> <span class="n">expected_condition</span> <span class="o">!=</span> <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;nonvolatile_condition&#39;</span><span class="p">]</span> <span class="ow">and</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s2">&quot;faint&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Pokemon&#39;s current non-volatile condition is &quot;</span>
                             <span class="s2">&quot;inconsistent with the expected condition for this&quot;</span>
                             <span class="s2">&quot; effect.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Pokemon&#39;s current state:</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Expected condition: {1}.&quot;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slot</span><span class="p">,</span> <span class="n">expected_condition</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recovery</span><span class="p">:</span>
            <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;nonvolatile_condition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;nonvolatile_condition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span>

        <span class="k">return</span> <span class="n">battle_state</span></div></div>


<div class="viewcode-block" id="StageChange"><a class="viewcode-back" href="../../onix.html#onix.battle.StageChange">[docs]</a><span class="k">class</span> <span class="nc">StageChange</span><span class="p">(</span><span class="n">StageChange_</span><span class="p">,</span> <span class="n">Effect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A change in a stat&#39;s stage (e.g. -1 Atk due to Intimidate)</span>

<span class="sd">    Args:</span>
<span class="sd">        slot (Slot) : the slot of the affected Pokemon</span>
<span class="sd">        stat (str) : the affected stat</span>
<span class="sd">        old_stage (int) : the pre-event stage (0 is normal)</span>
<span class="sd">        new_stage (int) : the post-event stage (0 is normal)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="StageChange.apply_effect"><a class="viewcode-back" href="../../onix.html#onix.battle.StageChange.apply_effect">[docs]</a>    <span class="k">def</span> <span class="nf">apply_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">battle_state</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the stage change</span>

<span class="sd">        Args:</span>
<span class="sd">            battle_state (BattleState) : the battle state to which to apply</span>
<span class="sd">                the effect</span>
<span class="sd">            inplace (:obj:`bool`, optional) : if ``False``, makes a copy of the</span>
<span class="sd">                battle state before applying the effect, if ``True``, operate</span>
<span class="sd">                in-place. Default is ``True``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BattleState : the updated battle state</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError : if ``self.stat`` is &quot;hp&quot; (there are no HP stages)</span>
<span class="sd">            ValueError : if the old stage of the specified Pokemon isn&#39;t what is</span>
<span class="sd">                specified by the effect.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat</span> <span class="o">==</span> <span class="s1">&#39;hp&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;HP doesn&#39;t have stages&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">battle_state</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">slot</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">side</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="c1"># sanity check</span>
        <span class="k">if</span> <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;stages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">stat</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_stage</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Pokemon&#39;s current {0} stage is inconsistent &quot;</span>
                             <span class="s2">&quot;with the expected stage for this effect.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Pokemon&#39;s current state:</span><span class="se">\n</span><span class="s2">{1}</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Expected {0} stage: {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stat</span><span class="p">,</span> <span class="n">slot</span><span class="p">,</span>
                                                              <span class="bp">self</span><span class="o">.</span><span class="n">old_stage</span><span class="p">))</span>

        <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;stages&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;stages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stat</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_stage</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">battle_state</span></div></div>


<div class="viewcode-block" id="FieldChange"><a class="viewcode-back" href="../../onix.html#onix.battle.FieldChange">[docs]</a><span class="k">class</span> <span class="nc">FieldChange</span><span class="p">(</span><span class="n">FieldChange_</span><span class="p">,</span> <span class="n">Effect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A change in a field conditions (e.g. weather)</span>

<span class="sd">    Args:</span>
<span class="sd">        side (1, 2 or None) : the side affected (``None`` corresponds to both</span>
<span class="sd">            sides)</span>
<span class="sd">        field_condition (str) : the field condition</span>
<span class="sd">        ending (bool) : ``False`` if the field condition is starting, ``True``</span>
<span class="sd">            if the field effect is ending</span>

<span class="sd">    Note:</span>
<span class="sd">        Stacking entry hazards should be handled as the previous level ending</span>
<span class="sd">        and the next level beginning, e.g., laying down a second layer of</span>
<span class="sd">        spikes would be represented by</span>
<span class="sd">        ``[FieldChange(1, &#39;spikes_1&#39;, True),</span>
<span class="sd">        FieldChange(1, &#39;spikes_2&#39;, False)]``</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FieldChange.apply_effect"><a class="viewcode-back" href="../../onix.html#onix.battle.FieldChange.apply_effect">[docs]</a>    <span class="k">def</span> <span class="nf">apply_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">battle_state</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the field condition change</span>

<span class="sd">        Args:</span>
<span class="sd">            battle_state (BattleState) : the battle state to which to apply</span>
<span class="sd">                the effect</span>
<span class="sd">            inplace (:obj:`bool`, optional) : if ``False``, makes a copy of the</span>
<span class="sd">                battle state before applying the effect, if ``True``, operate</span>
<span class="sd">                in-place. Default is ``True``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BattleState : the updated battle state</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError : if you&#39;re trying to end a field condition that&#39;s not</span>
<span class="sd">                currently active or start one that&#39;s already active</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">battle_state</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            
        <span class="n">side</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">side</span>
        <span class="k">if</span> <span class="n">side</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">side</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">field_conditions</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">field_conditions</span><span class="p">[</span><span class="n">side</span><span class="p">]</span>

        <span class="c1"># sanity check</span>
        <span class="n">has_condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_condition</span> <span class="ow">in</span> <span class="n">field_conditions</span>
        <span class="k">if</span> <span class="n">has_condition</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ending</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The current field conditions are &quot;</span>
                             <span class="s2">&quot;inconsistent with the expected conditions for &quot;</span>
                             <span class="s2">&quot;this effect.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Current conditions:</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Expected to have {1} condition: {2}&quot;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">field_conditions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_condition</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">ending</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ending</span><span class="p">:</span>
            <span class="n">field_conditions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_condition</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field_conditions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field_condition</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">battle_state</span></div></div>


<div class="viewcode-block" id="MovesetChange"><a class="viewcode-back" href="../../onix.html#onix.battle.MovesetChange">[docs]</a><span class="k">class</span> <span class="nc">MovesetChange</span><span class="p">(</span><span class="n">MovesetChange_</span><span class="p">,</span> <span class="n">Effect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A change in an attribute of a Pokemon that&#39;s considered part of its Moveset</span>
<span class="sd">    (e.g. item, ability, stats...). This includes mega evolution and other forme</span>
<span class="sd">    changes.</span>

<span class="sd">    Note:</span>
<span class="sd">        The way to handle volatile changes (e.g. ability suppression or stat</span>
<span class="sd">        changes due to, say, Power Swap) is to revert the change on switch-out.</span>

<span class="sd">    Args:</span>
<span class="sd">        slot (Slot) : the slot of the affected Pokemon</span>
<span class="sd">        old_moveset (Moveset) : the pre-event moveset</span>
<span class="sd">        new_moveset (Moveset) : the post-event moveset</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="MovesetChange.apply_effect"><a class="viewcode-back" href="../../onix.html#onix.battle.MovesetChange.apply_effect">[docs]</a>    <span class="k">def</span> <span class="nf">apply_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">battle_state</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the non-volatile condition change</span>

<span class="sd">        Args:</span>
<span class="sd">            battle_state (BattleState) : the battle state to which to apply</span>
<span class="sd">                the effect</span>
<span class="sd">            inplace (:obj:`bool`, optional) : if ``False``, makes a copy of the</span>
<span class="sd">                battle state before applying the effect, if ``True``, operate</span>
<span class="sd">                in-place. Default is ``True``.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BattleState : the updated battle state</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError : if the old moveset of the specified Pokemon isn&#39;t what</span>
<span class="sd">                is expected by the effect.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">inplace</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">battle_state</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">slot</span> <span class="o">=</span> <span class="n">battle_state</span><span class="o">.</span><span class="n">teams</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">side</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">slot</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="c1"># sanity check</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_moveset</span> <span class="o">!=</span> <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;moveset&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Pokemon&#39;s current moveset is inconsistent &quot;</span>
                             <span class="s2">&quot;with the expected moveset for this effect.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Pokemon&#39;s current state:</span><span class="se">\n</span><span class="s2">{0}</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Expected moveset: {1}.&quot;</span>
                             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_moveset</span><span class="p">))</span>

        <span class="n">slot</span><span class="p">[</span><span class="s1">&#39;moveset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_moveset</span>

        <span class="k">return</span> <span class="n">battle_state</span></div></div>


<div class="viewcode-block" id="Event"><a class="viewcode-back" href="../../onix.html#onix.battle.Event">[docs]</a><span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Something that happened in a battle, e.g., a move or an ability being</span>
<span class="sd">    triggered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="nd">@abc.abstractmethod</span>
<div class="viewcode-block" id="Event.get_cause"><a class="viewcode-back" href="../../onix.html#onix.battle.Event.get_cause">[docs]</a>    <span class="k">def</span> <span class="nf">get_cause</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the cause of the event (e.g. the move or the field effect)</span>

<span class="sd">        Returns:</span>
<span class="sd">            object : the cause of the event</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

    <span class="nd">@abc.abstractmethod</span>
<div class="viewcode-block" id="Event.get_effects"><a class="viewcode-back" href="../../onix.html#onix.battle.Event.get_effects">[docs]</a>    <span class="k">def</span> <span class="nf">get_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the effects of the event (e.g. the damage dealt)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            :obj:`iterable` of `Effect` : the effects of the event</span>

<span class="sd">        &quot;&quot;&quot;</span></div></div>


<div class="viewcode-block" id="Move"><a class="viewcode-back" href="../../onix.html#onix.battle.Move">[docs]</a><span class="k">class</span> <span class="nc">Move</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A move used by a Pokemon in a battle</span>

<span class="sd">    Args:</span>
<span class="sd">        move (str) : the name of the move</span>
<span class="sd">        user (Slot) : the slot of the Pokemon who used the move</span>
<span class="sd">        targets (:obj:`iterable` of :obj:`Slot`) : the slots of the Pokemon</span>
<span class="sd">            targeted by the move</span>
<span class="sd">        effects (:obj:`iterable` of :obj:`Effect`) : the effects of the move</span>
<span class="sd">        failure_reason (:obj:`str`, optional) : if the move failed, specify the</span>
<span class="sd">            reason why. If no reason is given, the move will be considered to</span>
<span class="sd">            have succeeded. Defaults to None (that is, to the move being</span>
<span class="sd">            successful)</span>
<span class="sd">    Attributes:</span>
<span class="sd">        move (str) : the name of the move</span>
<span class="sd">        user (Slot) : the slot of the Pokemon who used the move</span>
<span class="sd">        targets (:obj:`list` of :obj:`Slot`) : the slots of the Pokemon</span>
<span class="sd">            targeted by the move</span>
<span class="sd">        effects (:obj:`list` of :obj:`Effect`) : the effects of the move</span>
<span class="sd">        success (bool) : did the move succeed?</span>
<span class="sd">        failure_reason (str) : the reason why the move failed (if the move</span>
<span class="sd">            succeeded, then this will be None)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">move</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">effects</span><span class="p">,</span> <span class="n">failure_reason</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">move</span> <span class="o">=</span> <span class="n">move</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">effects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">effects</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">failure_reason</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">failure_reason</span> <span class="o">=</span> <span class="n">failure_reason</span>

<div class="viewcode-block" id="Move.get_cause"><a class="viewcode-back" href="../../onix.html#onix.battle.Move.get_cause">[docs]</a>    <span class="k">def</span> <span class="nf">get_cause</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the cause of the event, in this case, the move user and the move</span>
<span class="sd">        name</span>

<span class="sd">        Returns:</span>
<span class="sd">            (tuple) :</span>
<span class="sd">                * Slot : the slot of the move user</span>
<span class="sd">                * str : the name of the used move</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">move</span></div>

<div class="viewcode-block" id="Move.get_effects"><a class="viewcode-back" href="../../onix.html#onix.battle.Move.get_effects">[docs]</a>    <span class="k">def</span> <span class="nf">get_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Get the effects of the move (e.g. the damage dealt and any secondary</span>
<span class="sd">            effects)</span>

<span class="sd">            Returns:</span>
<span class="sd">                :obj:`iterable` of `Effect` : the effects of the event</span>

<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">effects</span></div></div>


<div class="viewcode-block" id="GenericEvent"><a class="viewcode-back" href="../../onix.html#onix.battle.GenericEvent">[docs]</a><span class="k">class</span> <span class="nc">GenericEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A non-move event (for now, the only event-type where we want additional</span>
<span class="sd">    structure is moves)</span>

<span class="sd">    Args:</span>
<span class="sd">        cause (str) : string representation of the cause of the event</span>
<span class="sd">        effects (:obj:`iterable` of :obj:`Effect`) : the effects of the event</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cause</span><span class="p">,</span> <span class="n">effects</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cause</span> <span class="o">=</span> <span class="n">cause</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">effects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">effects</span><span class="p">)</span>

<div class="viewcode-block" id="GenericEvent.get_cause"><a class="viewcode-back" href="../../onix.html#onix.battle.GenericEvent.get_cause">[docs]</a>    <span class="k">def</span> <span class="nf">get_cause</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the cause of the event (e.g. the field effect or item)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str : a string representation of the cause of the event</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cause</span></div>

<div class="viewcode-block" id="GenericEvent.get_effects"><a class="viewcode-back" href="../../onix.html#onix.battle.GenericEvent.get_effects">[docs]</a>    <span class="k">def</span> <span class="nf">get_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the effects of the event (e.g. the condition inflicted)</span>

<span class="sd">        Returns:</span>
<span class="sd">            :obj:`iterable` of `Effect` : the effects of the event</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">effects</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Antar.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>